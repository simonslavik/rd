SELECT sod.SalesOrderID, pc.Name as NazevKategorie,  ps.Name NazevPodKategorie, pp.Name as NazevProduktu, OrderDate as DatumObjednáni, ShipDate as DatumOdesláni, Day(ShipDate) - Day(OrderDate)  AS Rozdíl, sod.OrderQty*sod.UnitPrice as CelkovyProdej, Year(sod.ModifiedDate) as Rok, Month(sod.ModifiedDate) as Mesic, DATEPART(QUARTER, sod.ModifiedDate) as Kvartal
FROM sales.SalesOrderDetail sod 
join sales.SalesOrderHeader soh on sod.SalesOrderID=soh.SalesOrderID 
, Production.Product pp
join Production.ProductSubcategory ps on ps.ProductSubcategoryID=pp.ProductSubcategoryID 

join Production.ProductCategory pc on pc.ProductCategoryID=ps.ProductCategoryID 
