SELECT sod.SalesOrderID, pc.Name as NazevKategorie,  ps.Name NazevPodKategorie, pp.Name as NazevProduktu, (sod.OrderQty*sod.UnitPrice) as CelkovyProdej, Month(sod.ModifiedDate) as Mesic,
CASE WHEN (OrderQty*UnitPrice)<1500 THEN 'Podprumerný prodej'​
     WHEN (OrderQty*UnitPrice)>12000 THEN 'Nadprúmerný prodej'​
     ELSE 'Prumerný prodej' END AS CustomerCategory​
 FROM sales.SalesOrderDetail sod, Production.Product pp
join Production.ProductSubcategory ps on ps.ProductSubcategoryID=pp.ProductSubcategoryID 

join Production.ProductCategory pc on pc.ProductCategoryID=ps.ProductCategoryID 

where YEAR(sod.ModifiedDate) = '2011' AND DATEPART(QUARTER, sod.ModifiedDate) = 4 AND ps.Name =  'Mountain Bikes'

order by pc.Name, CustomerCategory​


